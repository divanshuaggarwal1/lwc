public with sharing class DataTable {
    @AuraEnabled
        public static void saveFieldData(String fieldData) {
            System.debug('fieldList = '+fieldData);

        List<cls_fieldList> fieldList = (List<cls_fieldList>) JSON.deserialize(fieldData, List<cls_fieldList>.class);
        System.debug('fieldList = '+fieldList);

        lwapic__X200_OK_Connect_Table__c connectTable = new lwapic__X200_OK_Connect_Table__c();
        connectTable.lwapic__ExternalSource__c = 'ZenDesk';
        connectTable.lwapic__Object_Name__c = 'Record';
        connectTable.lwapic__Service__c = 'ZenDesk';
        
        INSERT connectTable;
        List<lwapic__X200_OK_Connect_Table_Field__c> recordsToInsert = new List<lwapic__X200_OK_Connect_Table_Field__c>();
        for(cls_fieldList field : fieldList) {
            System.debug('field = '+field);
            System.debug('Name = '+field.name);
            lwapic__X200_OK_Connect_Table_Field__c newRecord = new lwapic__X200_OK_Connect_Table_Field__c();
            newRecord.lwapic__X200_OK_Connect_Table__c	     = connectTable.Id;
            newRecord.lwapic__Field_Api_Name__c              = field.name;  
            newRecord.lwapic__Type__c                        = field.fieldType;
            newRecord.lwapic__Decimal_Places__c              = String.isEmpty(field.decimalValue) ? null : Decimal.valueOf(field.decimalValue);
            newRecord.lwapic__Length__c                      = String.isEmpty(field.length) ? null : Integer.valueOf(field.length);
            newRecord.lwapic__Filterable__c                  = field.filterable;
            newRecord.lwapic__IsExternalId__c                = field.externalId;
            newRecord.lwapic__Sortable__c                    = field.sortable;
            System.debug('Preparing to insert: ' + newRecord);

            recordsToInsert.add(newRecord);
        }
        if (!recordsToInsert.isEmpty()) {
            insert recordsToInsert;
            System.debug('recordsToInsert.get(0).Name:: '+recordsToInsert.get(0).Id);
            lwapic__X200_OK_Connect_Table_Field__c result = [SELECT Id, lwapic__Field_Api_Name__c FROM lwapic__X200_OK_Connect_Table_Field__c WHERE Id =: recordsToInsert.get(0).Id ];
            System.debug('result '+result);
        }
    }

    public class cls_fieldList {
        public Integer id ;
        public String name ;
        public String fieldType ;
        public String decimalValue ;
        public String length ;
        public Boolean filterable ;
        public Boolean externalId ;
        public Boolean sortable ;
        public Boolean disableDelete ;
        public Boolean isDecimalDisabled;
        public Boolean isLengthDisabled;
    }
    }





   
